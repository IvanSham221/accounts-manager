<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Ö–æ–¥ - –ú–µ–Ω–µ–¥–∂–µ—Ä –∏–≥—Ä–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
</head>
<body>
    <div class="login-container">
        <div class="login-form">
            <h1>üéÆ –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–æ–≤</h1>
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            
            <div id="authTabs" class="tabs">
                <button class="tab-btn active" onclick="showTab('login')">–í—Ö–æ–¥</button>
                <button class="tab-btn" onclick="showTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div id="loginTab" class="tab-content active">
                <form id="loginForm">
                    <div class="input-group">
                        <label for="loginEmail">Email:</label>
                        <input type="email" id="loginEmail" required class="input">
                    </div>
                    
                    <div class="input-group">
                        <label for="loginPassword">–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="loginPassword" required class="input">
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block">
                        <span id="loginBtnText">–í–æ–π—Ç–∏</span>
                        <span id="loginSpinner" class="loading-spinner" style="display:none"></span>
                    </button>
                </form>
            </div>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="registerTab" class="tab-content">
                <form id="registerForm">
                    <div class="input-group">
                        <label for="registerName">–§–ò–û:</label>
                        <input type="text" id="registerName" required class="input">
                    </div>
                    
                    <div class="input-group">
                        <label for="registerEmail">Email:</label>
                        <input type="email" id="registerEmail" required class="input">
                    </div>
                    
                    <div class="input-group">
                        <label for="registerPassword">–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤):</label>
                        <input type="password" id="registerPassword" required class="input" minlength="6">
                    </div>
                    
                    <div class="input-group">
                        <label for="registerConfirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="registerConfirmPassword" required class="input" minlength="6">
                    </div>
                    
                    <button type="submit" class="btn btn-success btn-block">
                        <span id="registerBtnText">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
                        <span id="registerSpinner" class="loading-spinner" style="display:none"></span>
                    </button>
                </form>
            </div>
            
            <div id="authError" class="error-message" style="display: none;"></div>
            
            <div class="login-footer">
                <p>–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏</p>
                <p>–†–∞–±–æ—Ç–∞–µ—Ç –∏ –æ—Ñ—Ñ–ª–∞–π–Ω</p>
            </div>
        </div>
    </div>

    <script src="firebase.js"></script>
    <script>
        // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName + 'Tab').classList.add('active');
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const btnText = document.getElementById('loginBtnText');
            const spinner = document.getElementById('loginSpinner');
            const errorDiv = document.getElementById('authError');
            
            btnText.textContent = '–í—Ö–æ–¥...';
            spinner.style.display = 'inline-block';
            errorDiv.style.display = 'none';
            
            const result = await firebaseManager.login(email, password);
            
            spinner.style.display = 'none';
            btnText.textContent = '–í–æ–π—Ç–∏';
            
            if (result.success) {
                // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                window.location.href = 'manager.html';
            } else {
                errorDiv.textContent = result.error;
                errorDiv.style.display = 'block';
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const btnText = document.getElementById('registerBtnText');
            const spinner = document.getElementById('registerSpinner');
            const errorDiv = document.getElementById('authError');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π
            if (password !== confirmPassword) {
                errorDiv.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (password.length < 6) {
                errorDiv.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
                errorDiv.style.display = 'block';
                return;
            }
            
            btnText.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...';
            spinner.style.display = 'inline-block';
            errorDiv.style.display = 'none';
            
            const result = await firebaseManager.register(email, password, name);
            
            spinner.style.display = 'none';
            btnText.textContent = '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
            
            if (result.success) {
                // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                window.location.href = 'manager.html';
            } else {
                errorDiv.textContent = result.error;
                errorDiv.style.display = 'block';
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –µ—Å–ª–∏ —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
        document.addEventListener('DOMContentLoaded', function() {
            const user = firebaseManager.getCurrentUser();
            if (user) {
                window.location.href = 'manager.html';
            }
        });
    </script>
    
    <style>
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: var(--gray);
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</body>
</html>